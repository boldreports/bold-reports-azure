/*!
*  filename: share-permission-v2.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function intializeGetLinkDialog(){$.ajax({type:"Get",url:getLinkDialogViewUrl,success:function(n){$("body").append(n);$("#get_item_link").ejDialog({width:window.innerWidth>460?"450px":window.innerWidth-10,showOnInit:!1,allowDraggable:!1,enableResize:!1,height:"auto",title:window.Server.App.LocalizationContent.GetLink,showHeader:!1,enableModal:!0,closeOnEscape:!0,close:"onGetLinkDialogClose"});var t=createLoader("get_item_link_wrapper");$("#get_item_link_wrapper").ejWaitingPopup({template:$("#"+t)})}})}function GetLink(n){var t=n.ItemType,i,r;t==3?$(".report-link").show():t==6?($(".file-link").show(),$("#compressed-link").prop("checked",!0)):t==8?$(".widget-link").show():$(".link").show();i=n.Name;r=n.Id;$("#get_item_link").ejDialog("open");$("#get_item_link").show();$("#get_item_link_wrapper").ejWaitingPopup("show");$(".get_link").show();n.IsPublic?($(".private-note").hide(),$(".public-note").show()):($(".private-note").show(),$(".public-note").hide());/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?($("#item-link-copy").removeClass("su su-copy"),$("#item-link-copy").hide(),$("#item-link").css({width:"100%",borderRadius:"4px"}),$("#item-link-copy").attr("data-original-title","")):$("#item-link-copy").tooltip({animation:!1});$(".report-name").html(i);$(".report-name").attr("title",i);$("#item-link").val(getDashboardShareLink(n.Id,n.CategoryName,n.Name));$("#item-link").select();$(".modal-footer .validation-area").css("display","block");$("#get_item_link_wrapper").ejWaitingPopup("hide")}function onGetLinkDialogClose(){$("#get_item_link").ejDialog("close")}function onGetLinkDialogOpen(){$("#get_item_link").ejDialog("open");$("#get_item_link").show();$("#get_item_link").focus();$("#item-link").select();$(".get_link").show();$("#item-link").val(itemUrl);/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&($("#item-link-copy").removeClass("su su-copy"),$("#item-link-copy").hide(),$("#item-link-copy").attr("data-original-title",""))}function getDashboardShareLink(n,t,i){var r=baseUrl.split("/");return encodeURI(r[0]+"//"+r[2]+viewDashboardUrlAction+"/"+n+"/"+t+"/"+i)}function sharePermission(n){$("#permission-popup iframe").attr("src",permissionIframeUrl+"?itemId="+n);$("#permission-popup").ejDialog("open");ShowWaitingProgress("#permission-popup_wrapper","show")}function shareDashboardPermission(n,t){var u;currentItemDetail=n;sharePermissionDlgHeaderItemName.text(currentItemDetail.Name);sharePermissionDlgObj.show();var f=window.granularPermissions!=null?window.granularPermissions.All||window.granularPermissions.ReportsSettings:!1,r=window.granularPermissions!=null?window.granularPermissions.Report:!1,e=window.granularPermissions!=null?window.granularPermissions.Dataset:!1,o=window.granularPermissions!=null?window.granularPermissions.Datasource:!1,s=window.granularPermissions!=null?window.granularPermissions.Category:!1,i=angular.element("#share-permission-content-section").scope();i.currentItemType=n.ItemType;i.isAdmin=isAdmin;i.hasDashboardSettingsPermission=isAdmin||f;$("#share-permission-popup_wrapper, #user-group-search-input_suggestion").addClass("custom-bootstrap-styles");sharePermissionDlgObj.ejDialog("open");n.ItemType==ItemType.Report?n.CreatedById==currentUserId||isAdmin||r?(isMarkItemsPublic?n.IsPublic?showPublicContent():showPrivateContent():showDashboardSettingContent(),addAttributeValueToBtnEle(n)):hidePublicPrivateContent():hidePublicPrivateContent();n.ItemType==ItemType.Report?n.CreatedById==currentUserId||isAdmin||r?(showShareUserGroupPermissionSection(),getShareItemPermission(n.Id),addAttributeValueToBtnEle(n),addAttributeValueToAutoCompleteEle(n)):hideShareUserGroupPermissionSection():n.ItemType==ItemType.Datasource?n.CreatedById==currentUserId||isAdmin||o?showShareDialogContent(n):hideShareUserGroupPermissionSection():n.ItemType==ItemType.Dataset?n.CreatedById==currentUserId||isAdmin||e?showShareDialogContent(n):hideShareUserGroupPermissionSection():n.ItemType==ItemType.Category?n.CreatedById==currentUserId||isAdmin||s?showShareDialogContent(n):hideShareUserGroupPermissionSection():n.CreatedById==currentUserId||isAdmin?showShareDialogContent(n):hideShareUserGroupPermissionSection();/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?($("#item-url-copy").hide(),$("#item-url").css({width:"100%",borderRadius:"4px"}),$("#item-url-copy").attr("data-original-title","")):$("#item-url-copy").tooltip({animation:!1});switch(n.ItemType){case ItemType.Report:$("#item-url").val(getDashboardShareLink(n.Id,n.CategoryName,n.Name,n.UnlistedCode,n.IsUnlisted));break;case ItemType.ItemView:u=getDashboardShareLink(t.Id,t.CategoryName,t.Name,null,!1);$("#item-url").val(u+"?viewid="+n.Id);break;default:$("#item-url").val("")}}function addGroupOwnerDialogOpen(){var t=$("#add-owner-button").attr("data-groupname"),n=$("#add-owner-button").attr("data-groupid"),i=angular.element("#share-permission-content-section").scope();currentItemDetail.ItemType=ItemType.UserManagement;i.currentItemType=ItemType.UserManagement;i.isAdmin=isAdmin;typeof BoldBIDashboard!="undefined"?sharePermissionDlgObj.BoldBIDashboardDialog({height:241}):sharePermissionDlgObj.ejDialog({height:241});sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.AddGroupOwnerBtn);sharePermissionDlgHeaderItemName.text(t);sharePermissionDlgObj.show();$("#share-permission-popup_wrapper, #user-group-search-input_suggestion").addClass("custom-bootstrap-styles");typeof BoldBIDashboard!="undefined"?sharePermissionDlgObj.BoldBIDashboardDialog("open"):sharePermissionDlgObj.ejDialog("open");hidePublicPrivateContent();getGroupUserPermission(n);addOwnerBtnObj.attr("data-item-id",n);addOwnerBtnObj.attr("data-name",t);addOwnerBtnObj.attr("data-itemtype",ItemType.UserManagement);autoCompleteHiddenEle.attr("data-item-id",n);autoCompleteHiddenEle.attr("data-itemtype",ItemType.UserManagement)}function showShareDialogContent(n){showShareUserGroupPermissionSection();getShareItemPermission(n.Id);addAttributeValueToBtnEle(n);addAttributeValueToAutoCompleteEle(n)}function onSharePermissionPopupOpen(){$('[data-toggle="popover"]').popover("hide");sharePermissionDlgWrapperObj.ejWaitingPopup("refresh");showSharePermissionContainer()}function onSharePermissionPopupClose(){currentItemDetail=[];$(".embed-configuration [type='checkbox']").removeAttr("checked");$('[data-toggle="popover"]').popover("hide");showSharePermissionContainer();sharePermissionDlgWrapperObj.ejWaitingPopup("refresh");sharePermissionDlgWrapperObj.ejWaitingPopup("hide");refreshDialogBoxPosition()}function showAccessModeContainer(){sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.SharePermissionAccessMode);accessModeContainer.show();accessModeChngBtnObj.show();accessModeCancelBtnObj.show();sharePermissionConatiner.hide();manageAccessButton.hide();shareBtnObj.hide();shareDoneBtnObj.hide();refreshDialogBoxPosition()}function showManageAccessContainer(){hidePublicPrivateContent();showSharedUserGroupContainer.hide();shareBtnObj.text(window.Server.App.LocalizationContent.AddPeopleBtn);addOwnerBtnObj.text(window.Server.App.LocalizationContent.AddPeopleBtn);sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.ManageAccess);dummyContainer.hide();autoCompleteInstance.getValue()==""&&(shareBtnObj.hide(),addOwnerBtnObj.hide());currentItemDetail.ItemType==ItemType.UserManagement&&($(".change-access-mode-selection span").removeClass("caret"),$(".change-access-mode-selection button").attr("disabled",!0));manageAccessBackButton.show();manageUserGroupContainer.show();manageAccessButton.hide();refreshUserGroupScroll();refreshDialogBoxPosition();generateProfileAvatar()}function hideManageAccessContainer(){manageUserGroupContainer.hide();manageAccessSaveBtnObj.hide();manageAccessCancelBtnObj.hide();embedCodeDoneBtnObj.hide();embedCodeContainer.hide();changeIndicatorBannerObj.css("visibility","hidden");resetPreRequestValues()}function showSharePermissionContainer(){currentItemDetail.ItemType==ItemType.UserManagement?(sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.AddGroupOwnerBtn),$(".show-shared-user-group-label").text("Group Owners :")):sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.SharePermissionDefault);dummyContainer.show();shareBtnObj.text(window.Server.App.LocalizationContent.SharePeopleBtn);enableAutocompleteAccessModeSelectionWithoutReset();refreshAutoComplete();sharePermissionConatiner.show();manageAccessButton.show();shareDoneBtnObj.show();manageAccessBackButton.hide();hideManageAccessContainer();accessModeContainer.hide();accessModeChngBtnObj.hide();accessModeCancelBtnObj.hide();displaySharedUserGroupInfo();currentItemDetail.ItemType==ItemType.Report&&(typeof currentItemDetail.Extension!="undefined"&&currentItemDetail.Extension.toLowerCase()==".rdl"?getEmbedLinkSection.show():getEmbedLinkSection.hide());embedCodeDoneBtnObj.hide();sharePermissionDlgHeaderItemName.show();sharePermisisonDlgHeader.css("line-height","");refreshDialogBoxPosition()}function showSharePermissionContainerWithRefresh(){$('[data-toggle="popover"]').popover("hide");resetToActualScope();hideManageAccessContainer();enableAutocompleteAccessModeSelectionWithoutReset();autoCompleteHiddenEle.attr("data-itemtype")!=ItemType.UserManagement?sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.SharePermissionDefault):sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.AddGroupOwnerBtn);displaySharedUserGroupInfo();dummyContainer.show();shareBtnObj.text(window.Server.App.LocalizationContent.SharePeopleBtn);addOwnerBtnObj.text(window.Server.App.LocalizationContent.AddGroupOwnerBtn);showPublicPrivateContent();sharePermissionConatiner.show();manageAccessButton.show();autoCompleteInstance.getValue()!=""?(autoCompleteHiddenEle.attr("data-itemtype")!=ItemType.UserManagement?shareBtnObj.show():addOwnerBtnObj.show(),manageAccessCancelBtnObj.show(),shareDoneBtnObj.hide()):shareDoneBtnObj.show();manageAccessBackButton.hide();accessModeContainer.hide();accessModeChngBtnObj.hide();accessModeCancelBtnObj.hide();refreshDialogBoxPosition()}function showDashboardSettingContent(){sharePermissionPublicSectionObj.hide();sharePermissionPrivateSectionObj.hide();sharePermissionDashboardSettingSectionObj.show()}function showPublicContent(){sharePermissionPublicSectionObj.show();sharePermissionPrivateSectionObj.hide();isItemPublic=!0}function showPrivateContent(){sharePermissionPublicSectionObj.hide();sharePermissionPrivateSectionObj.show();isItemPublic=!1}function showPublicOrPrivateContent(){isItemPublic?showPublicContent():showPrivateContent()}function showShareUserGroupPermissionSection(){sharePermissionUserGroupSectionObj.show()}function hideShareUserGroupPermissionSection(){sharePermissionUserGroupSectionObj.hide()}function hidePublicPrivateContent(){sharePermissionPublicSectionObj.hide();sharePermissionPrivateSectionObj.hide();sharePermissionDashboardSettingSectionObj.hide()}function showPublicPrivateContent(){var n=window.granularPermissions!=null?window.granularPermissions.Report:!1;currentItemDetail.ItemType==ItemType.Report?currentItemDetail.CreatedById==currentUserId||isAdmin||n?isMarkItemsPublic?isItemPublic?sharePermissionPublicSectionObj.show():sharePermissionPrivateSectionObj.show():sharePermissionDashboardSettingSectionObj.show():hidePublicPrivateContent():hidePublicPrivateContent()}function changeAccessMode(){sharePermissionDlgWrapperObj.ejWaitingPopup("show");showAccessModeContainer();isItemPublic?publicRadioBtnObj.prop("checked",!0):privateRadioBtnObj.prop("checked",!0);accessModeChngBtnObj.attr("disabled",!0);sharePermissionDlgWrapperObj.ejWaitingPopup("hide")}function getEmbedCode(){$("#embed-code").val(generateEmbedCode(currentItemDetail));embedCodeContainer.show();sharePermisisonDlgHeader.text(window.Server.App.LocalizationContent.EmbedCode);/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&getEmbedCodeCopyBtnobj.hide();currentItemDetail.IsPublic?($(".private-embed-code-note").hide(),$(".public-embed-code-note").show()):($(".private-embed-code-note").show(),$(".public-embed-code-note").hide());embedCodeDoneBtnObj.show();manageAccessBackButton.hide();manageAccessSaveBtnObj.hide();manageAccessCancelBtnObj.hide();sharePermissionDlgHeaderItemName.hide();sharePermisisonDlgHeader.css("line-height","32px");sharePermissionConatiner.hide();manageAccessButton.hide();shareBtnObj.hide();shareDoneBtnObj.hide();refreshDialogBoxPosition()}function addAttributeValueToBtnEle(n){accessModeChngBtnObj.attr("data-item-id",n.Id);accessModeChngBtnObj.attr("data-name",n.Name);accessModeChngBtnObj.attr("data-itemtype",n.ItemType);shareBtnObj.attr("data-item-id",n.Id);shareBtnObj.attr("data-name",n.Name);shareBtnObj.attr("data-itemtype",n.ItemType)}function addAttributeValueToAutoCompleteEle(n){autoCompleteHiddenEle.attr("data-item-id",n.Id);autoCompleteHiddenEle.attr("data-itemtype",n.ItemType)}function getShareItemPermission(n){sharePermissionDlgWrapperObj.ejWaitingPopup("show");$.ajax({type:"get",url:getShareItemPermissionUrl,data:{itemId:n},contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.status){var t=angular.element(manageUserGroupBodySection).scope();t.$apply(function(){angular.copy(n.SharedUserGroupList,sharedUserGroupsPreservedList);t.sharedUserGroups=n.SharedUserGroupList});t.$apply(function(){angular.copy(n.AccessModeOptionList,sharedAccessModePreservedList);t.accessModes=n.AccessModeOptionList});$(".change-access-mode-selection").selectpicker("refresh");$(".change-access-mode-selection .selectpicker").removeAttr("title");accessModeSelectionInput.html("");accessModeSelectionInput.append(n.AccessModeList);accessModeSelectionInput.selectpicker("refresh");refreshUserGroupScroll();sharePermissionDlgWrapperObj.ejWaitingPopup("hide");displaySharedUserGroupInfo();isEntireDOMRendered=!0;$('[data-toggle="tooltip"]').tooltip();$('[data-toggle="popover"]').popover()}},error:function(){WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3);sharePermissionDlgWrapperObj.ejWaitingPopup("hide")}})}function getGroupUserPermission(n){typeof BoldBIDashboard!="undefined"?sharePermissionDlgWrapperObj.BoldBIDashboardWaitingPopup("show"):sharePermissionDlgWrapperObj.ejWaitingPopup("show");$.ajax({type:"get",url:getGroupOwnersUrl,data:{groupId:n},contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.status){var t=angular.element(manageUserGroupBodySection).scope();t.$apply(function(){angular.copy(n.SharedUserGroupList,sharedUserGroupsPreservedList);t.sharedUserGroups=n.SharedUserGroupList});t.$apply(function(){angular.copy(n.AccessModeOptionList,sharedAccessModePreservedList);t.accessModes=n.AccessModeOptionList});currentItemDetail.ItemType==ItemType.UserManagement?$("#user-group-search-input_suggestion").removeClass("item-user-input_suggestion"):$("#user-group-search-input_suggestion").addClass("item-user-input_suggestion");$(".change-access-mode-selection").selectpicker("refresh");$(".change-access-mode-selection .selectpicker").removeAttr("title");$(".change-access-mode-selection span").removeClass("caret");$(".change-access-mode-selection button").attr("disabled",!0);accessModeSelectionInput.html("");accessModeSelectionInput.append(n.AccessModeList);accessModeSelectionInput.selectpicker("refresh");refreshUserGroupScroll();typeof BoldBIDashboard!="undefined"?sharePermissionDlgWrapperObj.BoldBIDashboardWaitingPopup("hide"):sharePermissionDlgWrapperObj.ejWaitingPopup("hide");displaySharedUserGroupInfo();isEntireDOMRendered=!0;$('[data-toggle="tooltip"]').tooltip();$('[data-toggle="popover"]').popover()}else n.permissionDenied!=undefined&&n.permissionDenied&&(WarningAlert(window.Server.App.LocalizationContent.AddGroupOwnerBtn,window.Server.App.LocalizationContent.UserManagementWarningAlert,7e3),typeof BoldBIDashboard!="undefined"?(sharePermissionDlgObj.BoldBIDashboardDialog("close"),sharePermissionDlgWrapperObj.BoldBIDashboardWaitingPopup("hide")):(sharePermissionDlgObj.ejDialog("close"),sharePermissionDlgWrapperObj.ejWaitingPopup("hide")))},error:function(){WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3);typeof BoldBIDashboard!="undefined"?sharePermissionDlgWrapperObj.BoldBIDashboardWaitingPopup("hide"):sharePermissionDlgWrapperObj.ejWaitingPopup("hide")}})}function displaySharedUserGroupInfo(){var r=angular.element(manageUserGroupBodySection).scope(),n=r.sharedUserGroups,t,i;n!=null&&(n.length>0?(t="",$.each(n,function(i,r){var u="<div class='shared-user-group-name'><span class='shared-user-group-name-label'>";i<3&&(u+=r.TargetUserId>0?r.DisplayName+"<\/span>":r.TargetGroupName+"<\/span>",u+=i!=n.length-1?"<span class='shared-user-group-name-comma'>,<\/span> <\/div>":"<\/div>",t+=u)}),showSharedUserGroupNameSection.html(t),manageUserGroupContainer.is(":visible")||showSharedUserGroupContainer.show()):showSharedUserGroupContainer.hide(),n.length>3?(i=n.length-3,showSharedUserGroupCount.text(i),showSharedUserGroupCountSection.show()):showSharedUserGroupCountSection.hide(),generateProfileAvatar())}function saveItemPermission(){sharePermissionDlgWrapperObj.ejWaitingPopup("show");splitUserGroupList();var t=userEmailList,i=groupIdList,r=accessModeSelectionInput.val(),n=shareBtnObj.attr("data-item-id"),u=shareBtnObj.attr("data-itemtype");$.ajax({type:"POST",url:sharepermissionUrl,data:{permissionList:JSON.stringify({mode:r,itemType:u,UserList:t,GroupList:i}),itemId:n},success:function(t){t.toString().toLowerCase()=="true"?(getShareItemPermission(n),refreshAutoComplete(),refreshAutocompleteAccessModeSelection()):WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)},error:function(){WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)}})}function addGroupOwnerPermission(){typeof BoldBIDashboard!="undefined"?sharePermissionDlgWrapperObj.BoldBIDashboardWaitingPopup("show"):sharePermissionDlgWrapperObj.ejWaitingPopup("show");splitUserGroupList();var t=userEmailList,i=groupIdList,r=accessModeSelectionInput.val(),n=addOwnerBtnObj.attr("data-item-id"),u=addOwnerBtnObj.attr("data-itemtype");$.ajax({type:"POST",url:addGroupOwnerPermissionUrl,data:{permissionList:JSON.stringify({mode:r,itemType:u,UserList:t,GroupList:i}),groupId:n},success:function(t){t.status?(getGroupUserPermission(n),refreshAutoComplete(),refreshAutocompleteAccessModeSelection()):t.permissionDenied!=undefined&&t.permissionDenied&&(WarningAlert(window.Server.App.LocalizationContent.AddGroupOwnerBtn,window.Server.App.LocalizationContent.UserManagementWarningAlert,7e3),typeof BoldBIDashboard!="undefined"?(sharePermissionDlgObj.BoldBIDashboardDialog("close"),sharePermissionDlgWrapperObj.BoldBIDashboardWaitingPopup("hide")):(sharePermissionDlgObj.ejDialog("close"),sharePermissionDlgWrapperObj.ejWaitingPopup("hide")))},error:function(){WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)}})}function updateBulkItemPermission(){var n=shareBtnObj.attr("data-item-id"),t=addOwnerBtnObj.attr("data-item-id");$.ajax({type:"POST",url:updateBulkItemPermissionUrl,data:{permissionList:addNewItemPermission,userMarkedForDeletionList:userMarkedForDeletionList,groupMarkedForDeletionList:groupMarkedForDeletionList,itemId:n,groupId:t},success:function(i){i.toString().toLowerCase()=="true"?(n!=undefined?getShareItemPermission(n):getGroupUserPermission(t),changeIndicatorBannerObj.css("visibility","hidden"),resetPreRequestValues(),manageAccessSaveBtnObj.hide(),manageAccessCancelBtnObj.hide(),shareDoneBtnObj.show(),enableAutomCompleteControl(),enableAutocompleteAccessModeSelection()):WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)},error:function(){WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)}})}function refreshDialogBoxPosition(){sharePermissionDlgObj.ejDialog({height:"auto"});isEntireDOMRendered&&(sharePermissionDlgObj.ejDialog({width:529}),sharePermissionDlgObj.ejDialog({width:530}));sharePermissionDlgWrapperObj.ejWaitingPopup("refresh");sharePermissionDlgObj.ejDialog("refresh")}function prepareRequestForAddItemPermission(){if(modifiedItemIndex.length>0){var t=angular.element(manageUserGroupBodySection).scope(),i=t.accessModes,n=t.sharedUserGroups,r=shareBtnObj.attr("data-itemtype");$.each(i,function(i,u){var o=u.Key,f=[],e=[];$.each(modifiedItemIndex,function(i,r){n[r].PermissionAccess!=sharedUserGroupsPreservedList[r].PermissionAccess&&n[r].PermissionAccess==u.Key&&(t.IsUserItem(r)?jQuery.inArray(n[r].Email,f)==-1&&f.push(n[r].Email):t.IsGroupItem(r)&&jQuery.inArray(n[r].TargetGroupId,e)==-1&&e.push(n[r].TargetGroupId))});(f.length>0||e.length>0)&&addNewItemPermission.push(JSON.stringify({mode:o,itemType:r,UserList:f,GroupList:e}))});$.each(modifiedItemIndex,function(i,r){n[r].PermissionAccess!=sharedUserGroupsPreservedList[r].PermissionAccess&&(t.IsUserItem(r)?jQuery.inArray(sharedUserGroupsPreservedList[r].PermissionId,userMarkedForDeletionList)==-1&&userMarkedForDeletionList.push(sharedUserGroupsPreservedList[r].PermissionId):t.IsGroupItem(r)&&jQuery.inArray(sharedUserGroupsPreservedList[r].PermissionId,groupMarkedForDeletionList)==-1&&groupMarkedForDeletionList.push(sharedUserGroupsPreservedList[r].PermissionId))})}}function resetPreRequestValues(){modifiedItemIndex=[];addNewItemPermission=[];userMarkedForDeletionList=[];groupMarkedForDeletionList=[]}function resetToActualScope(){var n=angular.element(manageUserGroupBodySection).scope();n.$apply(function(){angular.copy(sharedUserGroupsPreservedList,n.sharedUserGroups)});n.$apply(function(){angular.copy(sharedAccessModePreservedList,n.accessModes)});$(".change-access-mode-selection").selectpicker("refresh");$(".change-access-mode-selection .selectpicker").removeAttr("title");changeIndicatorBannerObj.css("visibility","hidden");resetPreRequestValues();$('[data-toggle="tooltip"]').tooltip();manageAccessSaveBtnObj.hide();manageAccessCancelBtnObj.hide();shareBtnObj.hide();shareDoneBtnObj.show()}function enableAutocompleteAccessModeSelectionWithoutReset(){autoCompleteControlEle.ejAutocomplete("enable");autoCompleteControlWrapperEle.find(".e-in-wrap.e-box.e-corner").removeClass("disable-autocomplete");accessModeSelectionInput.prop("disabled",!1);$(".selectpicker[data-id='access-mode-selection']").removeClass("disabled");$(".selectpicker[data-id='access-mode-selection']").removeClass("disable-autocomplete-access-mode-selection");accessModeSelectionInput.selectpicker("refresh")}function refreshAutocompleteAccessModeSelection(){accessModeSelectionInput.prop("selectedIndex",0);accessModeSelectionInput.selectpicker("refresh")}function enableAutocompleteAccessModeSelection(){accessModeSelectionInput.prop("disabled",!1);$(".selectpicker[data-id='access-mode-selection']").removeClass("disabled");$(".selectpicker[data-id='access-mode-selection']").removeClass("disable-autocomplete-access-mode-selection");refreshAutocompleteAccessModeSelection()}function disableAutocompleteAccessModeSelection(){accessModeSelectionInput.prop("disabled",!0);$(".selectpicker[data-id='access-mode-selection']").addClass("disabled");$(".selectpicker[data-id='access-mode-selection']").addClass("disable-autocomplete-access-mode-selection");refreshAutocompleteAccessModeSelection()}function onSuggestionListOpen(){manageUserGroupContainer.addClass("disable-element-opacity")}function onSuggestionListClose(){autoCompleteInstance.getValue()==""&&manageUserGroupContainer.removeClass("disable-element-opacity")}function refreshUserGroupScroll(){var n,t;manageUserGroupBodySection.is(":visible")&&($(".tooltip").tooltip("hide"),n=225,manageUserGroupBodySection.ejScroller({height:n,width:"100%",scrollerSize:7,buttonSize:0,enableTouchScroll:!0,scrollOneStepBy:20,scroll:function(){$(".tooltip").tooltip("hide");$('[data-toggle="popover"]').popover("hide")}}),t=manageUserGroupBodySection.ejScroller("instance"),t.model.height=n,t.refresh(),$(".manage-user-group-body-section .e-scrollbar").show(),generateProfileAvatar())}function generateEmbedCode(n){var t=getDashboardShareLink(n.Id,n.CategoryName,n.Name)+"?isembed=true";return t+=$("#embed-dashboard-comments").is(":checked")?"&report_comments=true":"",t+=$("#embed-views").is(":checked")?"&views=true":"",t+=$("#embed-export").is(":checked")?"&export=true":"","<iframe src='"+t+"' id='report-frame' width='100%' height='720px' allowfullscreen frameborder='0'><\/iframe>"}function extractXSRFTokenFromCookie(){var n=parent.document.cookie.split("; ").find(n=>n.startsWith("XSRF-TOKEN="));return n?n.split("=")[1]:null}function setXSRFRequestHeader(n){n.setRequestHeader("X-XSRF-TOKEN",extractXSRFTokenFromCookie())}function decodeHtmlAsString(n){var t=document.createElement("textarea");return t.innerHTML=n,t.value}var browser=ej.browserInfo();$(document).on("click","#item-link-copy",function(){$("#item-link").select();/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?($("#item-link-copy").removeClass("su su-copy"),$("#item-link-copy").attr("data-original-title","")):(document.execCommand("copy"),$("#item-link-copy").attr("data-original-title",window.Server.App.LocalizationContent.Copysuccess),$("#item-link-copy").tooltip("hide").attr("data-original-title",window.Server.App.LocalizationContent.Copysuccess).tooltip("fixTitle").tooltip("show"),setTimeout(function(){$("#item-link-copy").attr("data-original-title",window.Server.App.LocalizationContent.LinkCopy);$("#item-link-copy").tooltip()},3e3))});var sharePermissionDlgObj="",sharePermissionDlgWrapperObj="",sharePermisisonDlgHeader="",sharePermissionDlgHeaderItemName="",sharePermissionConatiner="",accessModeContainer="",dummyContainer="",embedCodeContainer="",sharePermissionDashboardSettingSectionObj="",sharePermissionPublicSectionObj="",sharePermissionPrivateSectionObj="",sharePermissionUserGroupSectionObj="",manageUserGroupContainer="",manageUserGroupBodySection="",getEmbedLinkSection="",changeIndicatorBannerObj="",shareWithLabelObj="",getLinkInputObj="",getLinkCopyLinkobj="",getEmbedCodeInputObj="",getEmbedCodeCopyBtnobj="",accessModeChangeLink="",manageAccessButton="",manageAccessBackButton="",manageAccessSaveBtnObj="",manageAccessCancelBtnObj="",shareDoneBtnObj="",shareBtnObj="",accessModeChngBtnObj="",accessModeCancelBtnObj="",embedCodeDoneBtnObj="",addOwnerBtnObj="",publicRadioBtnObj="",privateRadioBtnObj="",isItemPublic=!1,isEntireDOMRendered=!1,accessModeSelectionInput="",sharedUserGroupsPreservedList=[],sharedAccessModePreservedList=[],markForDeleteBtnObj="",removeMarkForDeleteBtnObj="",toggleMarkForDeletionObj="",modifiedItemIndex=[],addNewItemPermission=[],userMarkedForDeletionList=[],groupMarkedForDeletionList=[],showSharedUserGroupContainer="",showSharedUserGroupNameSection="",showSharedUserGroupName="",showSharedUserGroupCountSection="",showSharedUserGroupCount="",currentItemDetail=[],shareItem=angular.module("sharePermission",[]);shareItem.controller("shareItemController",["$scope",function(n){n.currentUserId=window.currentUserId;n.sharedUserGroups=window.sharedUserGroupList;n.currentItemType=ItemType.Report;n.accessModes=window.accessModeList;n.showPopover=!1;n.hasDashboardSettingsPermission=!1;n.isUnlisted=!1;n.formatAccessModeString=function(n){return n.toString()};n.ImageLink=function(n){return idpUrl+"/User/Avatar?id="+n+"&ImageSize=64"};var t=["#4FDFDB","#BDDF4F","#F3DF4C","#FC9C61","#CBA6FF","#77BDFF"];n.GetGroupColor=function(n,i){var r=t[(i+1)%t.length-1];return n!=""?{"background-color":"#dfdfdf"}:{"background-color":"#dfdfdf"}};n.typeOptions=[{Key:2,Value:"Read"}];n.parseInt=function(n){return parseInt(n,10)};n.updateValue=function(t,i){n.CheckForModification(t,i)};n.MarkForDeletion=function(t,i,r){n.AddItemInUserGroupDeletionList(r);n.RemoveFromModified(r);var u=angular.element(t.currentTarget).parents(".shared-user-group-list-section").children();u.find(".action-for-delete-container").hide();u.find(".marked-for-delete-container").show();u.find(".change-indicator").show();n.ShowChangeIndicatorBanner()};n.RemoveMarkForDeletion=function(t,i,r){n.RemoveItemInUserGroupDeletionList(r);var u=angular.element(t.currentTarget).parents(".shared-user-group-list-section").children();u.find(".marked-for-delete-container").hide();u.find(".action-for-delete-container").show();u.find(".change-indicator").hide();n.CheckForModification(i,r)};n.CheckForModification=function(t,i){sharedUserGroupsPreservedList[i].PermissionAccess!=t?(n.AddToModified(i),$("#select_"+i).parents(".shared-user-group-list-section").children().find(".change-indicator").show()):sharedUserGroupsPreservedList[i].PermissionAccess==t&&(n.RemoveFromModified(i),$("#select_"+i).parents(".shared-user-group-list-section").children().find(".change-indicator").hide());n.ShowChangeIndicatorBanner()};n.ShowChangeIndicatorBanner=function(){$(".change-indicator").is(":visible")?(changeIndicatorBannerObj.css("visibility","visible"),manageAccessSaveBtnObj.show(),manageAccessCancelBtnObj.show(),shareDoneBtnObj.hide(),disableAutomCompleteControl(),disableAutocompleteAccessModeSelection()):(changeIndicatorBannerObj.css("visibility","hidden"),resetPreRequestValues(),manageAccessSaveBtnObj.hide(),manageAccessCancelBtnObj.hide(),shareDoneBtnObj.show(),enableAutomCompleteControl(),enableAutocompleteAccessModeSelection())};n.AddItemInUserGroupDeletionList=function(t){n.IsUserItem(t)?jQuery.inArray(sharedUserGroupsPreservedList[t].PermissionId,userMarkedForDeletionList)==-1&&userMarkedForDeletionList.push(sharedUserGroupsPreservedList[t].PermissionId):n.IsGroupItem(t)&&jQuery.inArray(sharedUserGroupsPreservedList[t].PermissionId,groupMarkedForDeletionList)==-1&&groupMarkedForDeletionList.push(sharedUserGroupsPreservedList[t].PermissionId)};n.RemoveItemInUserGroupDeletionList=function(t){n.IsUserItem(t)?jQuery.inArray(sharedUserGroupsPreservedList[t].PermissionId,userMarkedForDeletionList)!=-1&&(userMarkedForDeletionList=jQuery.grep(userMarkedForDeletionList,function(n){return n!=sharedUserGroupsPreservedList[t].PermissionId})):n.IsGroupItem(t)&&jQuery.inArray(sharedUserGroupsPreservedList[t].PermissionId,groupMarkedForDeletionList)!=-1&&(groupMarkedForDeletionList=jQuery.grep(groupMarkedForDeletionList,function(n){return n!=sharedUserGroupsPreservedList[t].PermissionId}))};n.AddToModified=function(n){jQuery.inArray(n,modifiedItemIndex)==-1&&modifiedItemIndex.push(n)};n.RemoveFromModified=function(n){modifiedItemIndex=jQuery.grep(modifiedItemIndex,function(t){return t!=n})};n.IsUserItem=function(n){return sharedUserGroupsPreservedList[n].Email!=null&&sharedUserGroupsPreservedList[n].IsUserPermission&&sharedUserGroupsPreservedList[n].TargetUserId>0};n.IsGroupItem=function(n){return sharedUserGroupsPreservedList[n].Email==null&&!sharedUserGroupsPreservedList[n].IsUserPermission&&sharedUserGroupsPreservedList[n].TargetGroupId>0};n.GetManagePermisisionContent=function(t){var f=window.granularPermissions!=null?window.granularPermissions.Reports:!1,i=window.Server.App.LocalizationContent.RemoveAccess,r,u;return n.IsUserItem(t)?(i=i+window.Server.App.LocalizationContent.PermissionGlobally+" - <strong>"+sharedUserGroupsPreservedList[t].PermissionEntityDescription+"<\/strong>.<\/br><\/br>",isAdmin||f?(r=editUserPermissionUrl+"?userId="+sharedUserGroupsPreservedList[t].TargetUserId,i+window.Server.App.LocalizationContent.ManagePermission+" <a target='_blank' href='"+r+"'>"+window.Server.App.LocalizationContent.Here+"<\/a>."):i+window.Server.App.LocalizationContent.UserContactSystemAdministrator):(i=i+window.Server.App.LocalizationContent.AssignedGlobally+" - <strong>"+sharedUserGroupsPreservedList[t].PermissionEntityDescription+"<\/strong>.<\/br><\/br>",isAdmin?(u=editGroupPermissionUrl+"?groupId="+sharedUserGroupsPreservedList[t].TargetGroupId,i+window.Server.App.LocalizationContent.ManagePermission+" <a target='_blank' href='"+u+"'>"+window.Server.App.LocalizationContent.Here+"<\/a>."):i+window.Server.App.LocalizationContent.GroupContactSystemAdministrator)}}]);$(function(){var n,t;sharePermissionDlgObj=$("#share-permission-popup");sharePermisisonDlgHeader=$("#share-permission-dialog-header");sharePermissionDlgHeaderItemName=$(".item-name-container #item-name-header");sharePermissionConatiner=$("#share-permission-container");accessModeContainer=$("#access-mode-container");dummyContainer=$("#dummy-container");embedCodeContainer=$("#get-embed-code-container");sharePermissionDashboardSettingSectionObj=$(".share-permission-dashboard-setting-section");sharePermissionPublicSectionObj=$(".share-permission-public-section");sharePermissionPrivateSectionObj=$(".share-permission-private-section");sharePermissionUserGroupSectionObj=$("#assign-user-group-container");manageUserGroupContainer=$("#manage-user-group-container");manageUserGroupBodySection=$(".manage-user-group-body-section");getEmbedLinkSection=$(".get-item-embed-link-section");changeIndicatorBannerObj=$(".changes-indicator-banner");shareWithLabelObj=$(".share-with-label");getLinkInputObj=$("#item-url");getLinkCopyLinkobj=$("#item-url-copy");getEmbedCodeInputObj=$("#embed-code");getEmbedCodeCopyBtnobj=$("#copy-embed-code");accessModeChangeLink=$("#access-mode-change-link");manageAccessButton=$("#manage-access-button");manageAccessBackButton=$("#manage-access-back-button");manageAccessSaveBtnObj=$("#manage-access-save-button");manageAccessCancelBtnObj=$("#manage-access-cancel-button");shareDoneBtnObj=$("#share-done-popup-button");shareBtnObj=$("#share-permission-button");accessModeChngBtnObj=$("#access-mode-change-button");accessModeCancelBtnObj=$("#access-mode-cancel-button");embedCodeDoneBtnObj=$("#copy-embed-code-done-button");addOwnerBtnObj=$("#add-owner-permission-button");publicRadioBtnObj=$("#public-access-mode");privateRadioBtnObj=$("#private-access-mode");accessModeSelectionInput=$("#access-mode-selection");markForDeleteBtnObj=$(".mark-for-deletion-icon");removeMarkForDeleteBtnObj=$(".remove-mark-for-deletion-icon");showSharedUserGroupContainer=$("#show-shared-user-group-container");showSharedUserGroupNameSection=$(".shared-user-group-name-section");showSharedUserGroupName=$(".shared-user-group-name");showSharedUserGroupCountSection=$(".shared-user-group-count-section");showSharedUserGroupCount=$(".shared-user-group-count");toggleMarkForDeletionObj=$(".action-for-delete-container, .marked-for-delete-container");$("#permission-popup").ejDialog({showOnInit:!1,allowDraggable:!0,enableResize:!1,width:"900px",title:"",showHeader:!1,enableModal:!0,close:"DialogBoxClose",closeOnEscape:!0});n=createLoader("permission-popup_wrapper");$("#permission-popup_wrapper").ejWaitingPopup({template:$("#"+n)});sharePermissionDlgObj.ejDialog({width:"529px",showOnInit:!1,allowDraggable:!1,enableResize:!1,showHeader:!1,enableModal:!0,closeOnEscape:!1,close:"onSharePermissionPopupClose",open:"onSharePermissionPopupOpen",closeOnEscape:!0});sharePermissionDlgWrapperObj=$("#share-permission-popup_wrapper");t=createLoader("share-permission-popup_wrapper");sharePermissionDlgWrapperObj.ejWaitingPopup({template:$("#"+t)});$("#share-close-popup, #share-done-popup-button").on("click",function(){sharePermissionDlgObj.ejDialog("close");parent.$("#sharePermissionPopup_iframe").hide()});accessModeCancelBtnObj.on("click",function(){showSharePermissionContainer()});manageAccessButton.on("click",function(){showManageAccessContainer()});manageAccessBackButton.on("click",function(){showSharePermissionContainerWithRefresh()});manageAccessSaveBtnObj.on("click",function(){$('[data-toggle="popover"]').popover("hide");sharePermissionDlgWrapperObj.ejWaitingPopup("show");prepareRequestForAddItemPermission();updateBulkItemPermission()});manageAccessCancelBtnObj.on("click",function(){$('[data-toggle="popover"]').popover("hide");resetToActualScope();enableAutomCompleteControl();enableAutocompleteAccessModeSelection()});getLinkCopyLinkobj.on("click",function(){getLinkInputObj.select();/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)?getLinkCopyLinkobj.attr("data-original-title",""):(document.execCommand("copy"),getLinkCopyLinkobj.attr("data-original-title",window.Server.App.LocalizationContent.Copysuccess),getLinkCopyLinkobj.tooltip("hide").attr("data-original-title",window.Server.App.LocalizationContent.Copysuccess).tooltip("fixTitle").tooltip("show"),setTimeout(function(){getLinkCopyLinkobj.attr("data-original-title",window.Server.App.LocalizationContent.LinkCopy);getLinkCopyLinkobj.tooltip()},3e3))});getLinkCopyLinkobj.removeClass("focusdiv");getLinkInputObj.on("focusin",function(){getLinkCopyLinkobj.addClass("focusdiv")});getLinkInputObj.on("focusout",function(){getLinkCopyLinkobj.removeClass("focusdiv")});$("input[type=radio][name=access-mode]").on("change",function(){isItemPublic&&privateRadioBtnObj.prop("checked")||!isItemPublic&&publicRadioBtnObj.prop("checked")?accessModeChngBtnObj.removeAttr("disabled"):accessModeChngBtnObj.attr("disabled",!0)});$(document).on("click","#access-mode-change-button",function(){var t=$(this).attr("data-item-id"),i=$(this).attr("data-name"),r=$(this).attr("data-itemtype"),n="";isItemPublic&&privateRadioBtnObj.prop("checked")?n=removeItemPublicUrl:!isItemPublic&&publicRadioBtnObj.prop("checked")&&(n=makeItemPublicUrl);$.ajax({type:"POST",url:n,data:{itemId:t,itemTypeId:r,itemName:i},success:function(n){n.validation&&n.result?(typeof ResetItemList=="function"&&ResetItemList(ItemType.Report),typeof currentItemDetail!="undefined"&&typeof currentItemDetail.IsPublic!="undefined"&&(currentItemDetail.IsPublic=!currentItemDetail.IsPublic)):WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)},error:function(){WarningAlert("",window.Server.App.LocalizationContent.InternalServerError,7e3)}});isItemPublic&&privateRadioBtnObj.prop("checked")?(showSharePermissionContainer(),showPrivateContent(),isItemPublic=!1):!isItemPublic&&publicRadioBtnObj.prop("checked")&&(showSharePermissionContainer(),showPublicContent(),isItemPublic=!0)});$(document).on("shown.bs.dropdown",".user-group-scroll-content .change-access-mode-select",function(){if($(".tooltip").hide(),$(this).find(".change-access-mode-selection").length>0){var n=manageUserGroupBodySection,i=$(this).offset().top+$(this).outerHeight(!0)/2-n.offset().top,r=n.height()-($(this).offset().top-n.offset().top+$(this).outerHeight(!0)/2),t=$(this).find(".change-access-mode-selection .dropdown-menu").outerHeight(!0);r<=t&&i>=t?$(this).find(".change-access-mode-selection").removeClass("dropdown").addClass("dropup"):refreshUserGroupScroll()}});$("body").on("click",function(n){$(n.target).data("toggle")!=="popover"&&$(n.target).parents('[data-toggle="popover"]').length===0&&$(n.target).parents(".popover.in").length===0?$('[data-toggle="popover"]').popover("hide"):$(n.target).data("toggle")=="popover"&&$(".access-info-icon").not(n.target).popover("hide")});getEmbedCodeInputObj.on("click",function(){getEmbedCodeInputObj.select()});getEmbedCodeCopyBtnobj.on("click",function(){getEmbedCodeInputObj.select();document.execCommand("copy");var n=$(".embed-copy-success");n.show();setTimeout(function(){n.fadeOut(3e3)},3e3)});embedCodeDoneBtnObj.on("click",function(){sharePermissionDlgObj.ejDialog("close")});$(".embed-configuration [type='checkbox']").on("change",function(){$("#embed-code").val(generateEmbedCode(currentItemDetail))})});$.ajaxSetup({beforeSend:function(n){setXSRFRequestHeader(n)}})