/*!
*  filename: publish-report.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function publishSiteDetailDialog(n){var r,i,u,t;publishedDashboardInfo=n;r='<span class ="publish-dialog-header">'+window.Server.App.LocalizationContent.PublishDialogHeader+"<\/span>";isPublishDialogBinded?(t=document.getElementById("publish-site-dialog").ej2_instances,t[0].header=r,t[0].btnObj[0].disabled=!0,t[0].show()):(i=document.createElement("div"),i.setAttribute("id","publish-site-dialog"),u=document.getElementById("dashboard-page-container"),u.appendChild(i),t=new ejs.popups.Dialog({header:r,content:document.getElementById("publish-site-content"),buttons:[{click:function(n){n.currentTarget.ej2_instances[0].content==window.Server.App.LocalizationContent.Back?backToPublishDialog():advancedPublishDialog()},buttonModel:{disabled:!0,content:window.Server.App.LocalizationContent.Advanced}},{click:function(n){n.currentTarget.ej2_instances[0].content==window.Server.App.LocalizationContent.Submit&&submitTargetSiteDetails();n.currentTarget.ej2_instances[0].content==window.Server.App.LocalizationContent.Next&&backToPublishDialog()},buttonModel:{isPrimary:!0,content:window.Server.App.LocalizationContent.Submit}},{click:function(){t.hide();$("#publish-advanced-container").hide()},buttonModel:{content:window.Server.App.LocalizationContent.CloseButton}},],animationSettings:{effect:"Zoom"},open:validatePublishItem,beforeOpen:beforeOpenPublishDialog,beforeClose:beforeClosePublishDialog,width:"700px",showCloseIcon:!0,isModal:!0}),t.appendTo(i),isPublishDialogBinded=!0);ejs.popups.createSpinner({target:document.getElementById("publish-site-dialog")});ejs.popups.setSpinner({type:"Material"});ejs.popups.showSpinner(document.getElementById("publish-site-dialog"))}function beforeOpenPublishDialog(){var n,t;$("#publish-site-content").show();$("#publish-advanced-container").hide();n=document.getElementById("publish-site-dialog").ej2_instances;isSelfHosted&&!0?($("#publish-base-container").hide(),$("#publish-select-site-container").show(),n[0].btnObj[1].content=window.Server.App.LocalizationContent.Next,n[0].btnObj[0].cssClass="display-none"):(n[0].btnObj[1].content=window.Server.App.LocalizationContent.Submit,n[0].btnObj[0].cssClass="",$("#publish-select-site-container").hide(),$("#publish-base-container").show(),t=angular.element("[ng-controller=PublishCtrl]").scope(),t.publishType="External")}function validatePublishItem(){$.ajax({type:"GET",url:validatePublishItemUrl,data:{itemId:publishedDashboardInfo.Id},success:function(n){var t,i;n.Result?(t=angular.element("[ng-controller=PublishCtrl]").scope(),ejs.popups.hideSpinner(document.getElementById("publish-site-dialog")),isSelfHosted&&!0?$("#internal-site").click():(t.publishType="External",backToPublishDialog())):(i=document.getElementById("publish-site-dialog").ej2_instances,i[0].hide(),WarningAlert(window.Server.App.LocalizationContent.PublishDashboard,window.Server.App.LocalizationContent.PublishItemValidation,7e3))}})}function beforeClosePublishDialog(){var n=angular.element("[ng-controller=PublishCtrl]").scope(),t=document.getElementById("publish-site-dialog").ej2_instances;t[0].btnObj[0].content=window.Server.App.LocalizationContent.Advanced;n.selectedSites=[];n.activeSites=[];n.selectedDatasources=[];n.TargetSiteDetail=[];n.userLists=[];n.updateDatasources=[];n.updateUser=[];n.updateSites=[];n.publishType="Internal";$("#multiselect-dropdown").empty();$("#multiselect-dropdown").selectpicker("refresh");$("#publish-category-name").val("");$("#publish-report-descrition").val("");$("#publish-report-edit").prop("checked",!1);$("#publish-datasource-edit").prop("checked",!1);removeCategoryValidation();removeDropdownValidation()}function advancedPublishDialog(){var t,n,i;isAdvancedPage=!0;ejs.popups.showSpinner(document.getElementById("publish-site-dialog"));t=document.getElementById("publish-site-dialog").ej2_instances;t[0].btnObj[0].content=window.Server.App.LocalizationContent.Back;t[0].btnObj[1].content=window.Server.App.LocalizationContent.Submit;n=angular.element("[ng-controller=PublishCtrl]").scope();$(".selected-sites li").hasClass("active")?(i=n.selectedSites.some(t=>t.TenantId==n.activeMenu.TenantId),i||(n.activeMenu=n.selectedSites[0])):(n.activeMenu=n.selectedSites[0],$(".selected-sites li:first").addClass("active"));n.$apply();updateUsersList()}function backToPublishDialog(){isAdvancedPage=!1;ejs.popups.showSpinner(document.getElementById("publish-site-dialog"));var t=angular.element("[ng-controller=PublishCtrl]").scope(),n=document.getElementById("publish-site-dialog").ej2_instances;isSelfHosted&&(n[0].btnObj[0].cssClass="",n[0].btnObj[1].content=window.Server.App.LocalizationContent.Submit);t.publishType=="Internal"?($("#active-sites-dropdown").removeClass("external-dropdown"),$("#publish-base-container .publish-container").removeClass("external-publish-separator")):($("#active-sites-dropdown").addClass("external-dropdown"),$("#publish-base-container .publish-container").addClass("external-publish-separator"));n[0].btnObj[0].content=window.Server.App.LocalizationContent.Advanced;$("#publish-base-container").show();$("#publish-advanced-container").hide();$("#publish-select-site-container").hide();$("#publish-report-name").val(publishedDashboardInfo.Name+"_"+$.now());$("#multiselect-dropdown > option").length===0?showActiveSites(t.publishType):(ejs.popups.hideSpinner(document.getElementById("publish-site-dialog")),updateTitleForDisabledItem())}function updateTitleForDisabledItem(){$("#active-sites-dropdown .dropdown-menu .inner .disabled").attr("data-toggle","tooltip");$("#active-sites-dropdown .dropdown-menu .inner li a").hasClass("no-sites")||$("#active-sites-dropdown .dropdown-menu .inner .disabled").attr("data-original-title",window.Server.App.LocalizationContent.ItemPublishedTitle);$('[data-toggle="tooltip"]').tooltip()}function showActiveSites(n){n==="Internal"?(updateActiveSites(),$("#active-sites-dropdown").removeClass("external-dropdown")):(updateExternalSites(),$("#active-sites-dropdown").addClass("external-dropdown"))}function updateUsersList(){var n=angular.element("[ng-controller=PublishCtrl]").scope();n.userDetail=[];$.each(n.selectedSites,function(t,i){$.ajax({type:"GET",url:getUsersPermissionUrl,data:{publishType:n.publishType,tenantId:i.TenantId},success:function(r){var u=[];typeof r.Sites!="undefined"&&($.each(r.Sites,function(t,i){n.userDetail.push({Name:i.DisplayName,Id:i.IdPReferenceId,UserId:i.UserId,IsSelected:t==0?!0:!1});angular.copy(n.userDetail,u)}),n.sampleDetail=n.publishType==="Internal"?{SiteIdentifier:i.SiteIdentifier,UserList:u}:{SiteIdentifier:i.TenantId,UserList:u},n.userLists.push(n.sampleDetail),n.sampleDetail=[],n.userDetail=[],n.selectedSites.length-1==t&&(n.selectedDatasources=[],$.ajax({type:"GET",url:getDatasourceUrl,data:{itemId:publishedDashboardInfo.Id},success:function(t){t.Datasources!=null&&$.each(t.Datasources,function(t,i){n.selectedDatasources.push({Id:i.DataSourceId,Name:i.DataSourceName,IsLocked:$("#publish-datasource-edit").is(":checked")})});resetAngularEvent&&(n.TargetSiteDetail=[],updateDatasourceIsLocked(),prepareTargetSiteDetail());resetAngularEvent=!1;pushUserList();pushDatasources();$("#user-selected").addClass("selectpicker");$("#user-selected").selectpicker("refresh");$("#publish-base-container").hide();$("#publish-select-site-container").hide();$("#publish-advanced-container").show();ejs.popups.hideSpinner(document.getElementById("publish-site-dialog"))}})))}})})}function submitTargetSiteDetails(){var t=canPublish(),n;t&&(ejs.popups.showSpinner(document.getElementById("publish-site-dialog")),isAdvancedPage?publishReport():(n=angular.element("[ng-controller=PublishCtrl]").scope(),n.selectedDatasources=[],$.ajax({type:"GET",url:getDatasourceUrl,data:{itemId:publishedDashboardInfo.Id},success:function(t){t.Datasources!=null&&$.each(t.Datasources,function(t,i){n.selectedDatasources.push({Id:i.DataSourceId,Name:i.DataSourceName,IsLocked:$("#publish-datasource-edit").is(":checked")})});publishReport()}})))}function publishReport(){var n=angular.element("[ng-controller=PublishCtrl]").scope(),i=document.getElementById("publish-site-dialog").ej2_instances,t;n.TargetSiteDetail.length==0&&(n.activeMenu=n.selectedSites[0],prepareTargetSiteDetail());pushUserList();pushDatasources();t={targetSiteDetail:JSON.stringify(n.TargetSiteDetail),itemId:publishedDashboardInfo.Id};$.ajax({type:"POST",url:publishReportUrl,data:t,success:function(n){n.Status?SuccessAlert(window.Server.App.LocalizationContent.PublishDashboard,window.Server.App.LocalizationContent.PublishSuccess,7e3):WarningAlert(window.Server.App.LocalizationContent.PublishDashboard,window.Server.App.LocalizationContent.PublishFailure,7e3);ejs.popups.hideSpinner(document.getElementById("publish-site-dialog"));i[0].hide()}})}function prepareTargetSiteDetail(){var n=angular.element("[ng-controller=PublishCtrl]").scope();$.each(n.selectedSites,function(t,i){var r=n.userLists.find(n=>n.SiteIdentifier==i.SiteIdentifier),u=[];angular.copy(n.selectedDatasources,u);n.sampleDetail={SiteIdentifier:i.SiteIdentifier,TenantId:i.TenantId,UserId:typeof r=="undefined"||r.UserList.length==0?0:r.UserList[0].UserId,IdpReferenceIdString:typeof r=="undefined"||r.UserList.length==0?null:r.UserList[0].Id,PublishItem:{CategoryName:$("#publish-category-name").val().trim(),Description:$("#publish-report-descrition").val().trim(),Name:$("#publish-report-name").val().trim(),IsLocked:$("#publish-report-edit").is(":checked")},Datasources:u,PublishType:n.publishType};n.TargetSiteDetail.push(n.sampleDetail);n.sampleDetail=[]});n.$apply()}function pushDatasources(){$("#datasource-list-dropdown").empty();var n=angular.element("[ng-controller=PublishCtrl]").scope(),t=n.TargetSiteDetail.find(t=>t.TenantId==n.activeMenu.TenantId);typeof t!="undefined"&&t.Datasources.length!=0&&$.each(t.Datasources,function(n,t){t.IsLocked?$("#datasource-list-dropdown").append('<option value="'+t.Id+'"selected>'+t.Name+"<\/option>"):$("#datasource-list-dropdown").append('<option value="'+t.Id+'">'+t.Name+"<\/option>")});n.selectedDatasources.length==0&&$("#datasource-list-dropdown").append("<option disabled>"+window.Server.App.LocalizationContent.NoDataSources+"<\/option>");$("#datasource-list-dropdown").selectpicker("refresh")}function pushUserList(){var n,t,i;$("#user-selected").empty();n=angular.element("[ng-controller=PublishCtrl]").scope();n.selectedUsers=[];t=[];t=n.publishType==="Internal"?n.userLists.find(t=>t.SiteIdentifier==n.activeMenu.SiteIdentifier):n.userLists.find(t=>t.SiteIdentifier==n.activeMenu.TenantId);i=n.TargetSiteDetail.find(t=>t.TenantId==n.activeMenu.TenantId);typeof t!="undefined"&&t.UserList.length!=0&&($.each(t.UserList,function(n,t){t.IsSelected?($("#user-selected").append('<option value="'+t.UserId+'"selected>'+t.Name+"<\/option>"),i.UserId=t.UserId,i.IdpReferenceIdString=t.Id):$("#user-selected").append('<option value="'+t.UserId+'">'+t.Name+"<\/option>")}),$("#user-selected").selectpicker("refresh"))}function removeCategoryValidation(){$("#publish-category-validation, #advanced-category-validation, #publish-plugin-validation, #advanced-plugin-validation").html("");$("#publish-category-name, #advanced-category-name").removeClass("has-error")}function removeDropdownValidation(){$("#active-sites-dropdown .bootstrap-select .selectpicker").removeClass("has-error");$("#add-external-sites .btn.btn-default").removeClass("has-error");$("#active-sites-validation").html("")}function canPublish(){var n=isAdvancedPage?$("#advanced-category-name").val().trim():$("#publish-category-name").val().trim();if($("#active-sites-dropdown li.selected").length>0){if(isAdvancedPage&&parent.isEmptyOrWhitespace(n))return $("#advanced-category-validation").html(""),$("#advanced-plugin-validation").html(window.Server.App.LocalizationContent.ItemNameValidator),$("#advanced-category-name").addClass("has-error"),!1;if(parent.isEmptyOrWhitespace(n))return $("#publish-category-validation").html(""),$("#publish-plugin-validation").html(window.Server.App.LocalizationContent.Categoryvalidator),$("#publish-category-name").addClass("has-error"),!1;removeCategoryValidation();removeDropdownValidation()}else return($("#active-sites-validation").html(window.Server.App.LocalizationContent.SelectSites),$("#active-sites-dropdown .bootstrap-select .selectpicker").addClass("has-error"),$("#add-external-sites .btn.btn-default").addClass("has-error"),isAdvancedPage&&parent.isEmptyOrWhitespace(n))?($("#advanced-category-validation").html(""),$("#advanced-plugin-validation").html(window.Server.App.LocalizationContent.ItemNameValidator),$("#advanced-category-name").addClass("has-error"),!1):parent.isEmptyOrWhitespace(n)?($("#publish-category-validation").html(""),$("#publish-plugin-validation").html(window.Server.App.LocalizationContent.Categoryvalidator),$("#publish-category-name").addClass("has-error"),!1):(removeCategoryValidation(),!1);return!0}function activateSubmit(){var n=document.getElementById("publish-site-dialog").ej2_instances,t=isAdvancedPage?$("#advanced-category-name").val().trim():$("#publish-category-name").val().trim();n[0].btnObj[0].disabled=$("#active-sites-dropdown li.selected").length>0&&!parent.isEmptyOrWhitespace(t)?!1:!0}function updateDatasourceIsLocked(){var n=angular.element("[ng-controller=PublishCtrl]").scope();$.each(n.selectedDatasources,function(n,t){t.IsLocked=$("#publish-datasource-edit").is(":checked")})}function updateActiveSites(){$.ajax({type:"GET",url:getActiveSitesUrl,data:{itemId:publishedDashboardInfo.Id},success:function(n){var t=angular.element("[ng-controller=PublishCtrl]").scope();$.each(n.Sites,function(n,i){t.activeSites.push({TenantId:i.TenantId,SiteIdentifier:i.TenantIdentifier,TenantName:i.TenantName});i.IsPublished?$("#multiselect-dropdown").append("<option id="+i.TenantId+" value="+i.TenantIdentifier+" disabled>"+i.TenantName+"<\/option>"):$("#multiselect-dropdown").append("<option id="+i.TenantId+" value="+i.TenantIdentifier+">"+i.TenantName+"<\/option>")});n.Sites.length==0&&$("#multiselect-dropdown").append('<option class = "no-sites" disabled>'+window.Server.App.LocalizationContent.NoActiveSites+"<\/option>");$("#multiselect-dropdown").selectpicker("refresh");ejs.popups.hideSpinner(document.getElementById("publish-site-dialog"));updateTitleForDisabledItem()}})}function isSiteNameExist(){return!$("#external-site-name").hasClass("has-error")}function getExternalSitesDetailDialog(){var r='<span class ="external-sites-dialog-header">'+window.Server.App.LocalizationContent.ExternalSiteDialogHeader+"<\/span>",t,i,n;isExternalSitesDialogBinded?(ejs.popups.hideSpinner(document.getElementById("external-site-dialog")),n=document.getElementById("external-site-dialog").ej2_instances,n[0].show()):(t=document.createElement("div"),t.setAttribute("id","external-site-dialog"),i=document.getElementById("dashboard-page-container"),i.appendChild(t),n=new ejs.popups.Dialog({header:r,content:document.getElementById("get-external-site-content"),buttons:[{click:function(n){var t=$("#dialog-container").valid();t&&!parent.$("#external-client-id, #external-client-secret, #external-site-url, #external-site-name").hasClass("has-error")?saveExternalSites():n.preventDefault()},buttonModel:{isPrimary:!0,content:window.Server.App.LocalizationContent.SaveButton}},{click:function(){n.hide()},buttonModel:{content:window.Server.App.LocalizationContent.CancelButton}},],animationSettings:{effect:"Zoom"},beforeOpen:beforeOpenExternalSitesDialog,beforeClose:beforeCloseExternalSitesDialog,width:"600px",showCloseIcon:!0,isModal:!0}),n.appendTo(t),isExternalSitesDialogBinded=!0,ejs.popups.createSpinner({target:document.getElementById("external-site-dialog")}),ejs.popups.setSpinner({type:"Material"}))}function beforeOpenExternalSitesDialog(){$("#get-external-site-content").show();$("#external-client-id").parent("div").removeClass("has-error");$("#external-client-secret").parent("div").removeClass("has-error");$("#external-site-url").parent("div").removeClass("has-error");$(".client-secret-validation-message, .clientid-validation-message, .site-url-validation-message, .name-validation-message").html("");parent.$("#external-client-id, #external-client-secret, #external-site-url, #external-site-name").removeClass("has-error")}function beforeCloseExternalSitesDialog(){$("#external-client-id, #external-client-secret, #external-site-url, #external-site-name").val("");$(".client-secret-validation-message, .clientid-validation-message, .site-url-validation-message, .name-validation-message").html("");parent.$("#external-client-id, #external-client-secret, #external-site-url, #external-site-name").removeClass("has-error")}function updateExternalSites(){$.ajax({type:"GET",data:{itemId:publishedDashboardInfo.Id},url:getExternalSitesUrl,success:function(n){var t,i;n.Status&&(t=angular.element("[ng-controller=PublishCtrl]").scope(),$.each(n.Result,function(n,i){t.activeSites.push({TenantId:i.ClientId.toLowerCase(),SiteIdentifier:"",TenantName:i.Name});i.IsPublished?$("#multiselect-dropdown").append("<option id="+i.ClientId.toLowerCase()+' value="" disabled>'+i.Name+"<\/option>"):$("#multiselect-dropdown").append("<option id="+i.ClientId.toLowerCase()+' value="" >'+i.Name+"<\/option>")}),n.Result.length==0&&$("#multiselect-dropdown").append('<option class = "no-sites" disabled>'+window.Server.App.LocalizationContent.NoActiveSites+"<\/option>"),$("#multiselect-dropdown").selectpicker("refresh"),ejs.popups.hideSpinner(document.getElementById("publish-site-dialog")),updateTitleForDisabledItem(),$("#external-site-dialog").length>0&&(i=document.getElementById("external-site-dialog").ej2_instances,i[0].hide()))}})}function saveExternalSites(){var n={Name:$("#external-site-name").val().trim(),ClientId:$("#external-client-id").val().trim(),ClientSecret:$("#external-client-secret").val().trim(),SiteURL:$("#external-site-url").val().trim()};ejs.popups.showSpinner(document.getElementById("external-site-dialog"));$.ajax({type:"POST",url:addExternalSitesUrl,data:{externalSite:n},success:function(n){var t,i;if(n.Status){if(n.Data){$(".name-validation-message").html(window.Server.App.LocalizationContent.SiteNameExist);parent.$("#external-site-name").addClass("has-error");ejs.popups.hideSpinner(document.getElementById("external-site-dialog"));return}if(!n.Result){$(".site-url-validation-message").html(window.Server.App.LocalizationContent.ExternalSiteUnavailable);parent.$("#external-site-url").addClass("has-error");ejs.popups.hideSpinner(document.getElementById("external-site-dialog"));return}$("#multiselect-dropdown").empty();$("#multiselect-dropdown").selectpicker("refresh");t=angular.element("[ng-controller=PublishCtrl]").scope();t.activeSites=[];updateExternalSites();SuccessAlert(window.Server.App.LocalizationContent.ExternalSiteDialogHeader,window.Server.App.LocalizationContent.ExternalSiteSuccess,7e3)}else ejs.popups.hideSpinner(document.getElementById("external-site-dialog")),WarningAlert(window.Server.App.LocalizationContent.ExternalSiteDialogHeader,window.Server.App.LocalizationContent.ExternalSiteFailure,7e3),i=document.getElementById("external-site-dialog").ej2_instances,i[0].hide()}})}function siteNameCheck(n){$.ajax({type:"POST",url:isSiteNameExistsUrl,data:{siteName:n},success:function(n){n.Status?($(".name-validation-message").html(window.Server.App.LocalizationContent.SiteNameExist),parent.$("#external-site-name").addClass("has-error")):($(".name-validation-message").html(""),parent.$("#external-site-name").removeClass("has-error"))}})}function deleteConfirmation(n){setTimeout(function(){var t=$("#ConnectedSitesGrid").data("ejGrid"),i=t.getCurrentViewData()[t.getIndexByRow($("tr.e-row[aria-selected *='true']"))];messageBox("su-delete",window.Server.App.LocalizationContent.DeleteConnectedSite,window.Server.App.LocalizationContent.DeleteSiteConfirm+'<span class ="highlight-name">'+i.Name+" ?<\/span>","error",function(){var t=createLoader("messageBox_wrapper");$("#messageBox_wrapper").ejWaitingPopup({template:$("#"+t)});$("#messageBox_wrapper").css("height",$("#messageBox").outerHeight());$("#messageBox_wrapper").ejWaitingPopup("show");removeExternalSite(n)})},100)}function removeExternalSite(n){var t=$(n).attr("data-id");$.ajax({type:"POST",url:removeExternalSiteUrl,data:{id:t},success:function(n){n.Status?(getExternalSites(),SuccessAlert(window.Server.App.LocalizationContent.DeleteConnectedSite,window.Server.App.LocalizationContent.DeleteSiteSuccess,7e3)):WarningAlert(window.Server.App.LocalizationContent.DeleteConnectedSite,window.Server.App.LocalizationContent.DeleteSiteFailure,7e3);$("#messageBox_wrapper").ejWaitingPopup("hide");onCloseMessageBox()}})}function getExternalSites(){$("#ConnectedSitesGrid").ejWaitingPopup("show");$.ajax({type:"GET",url:getExternalSitesUrl,success:function(n){if(n.Status){var t=$("#ConnectedSitesGrid").data("ejGrid");t.dataSource(n.Result)}$("#ConnectedSitesGrid").ejWaitingPopup("hide")}})}var publishedDashboardInfo="",isPublishDialogBinded=!1,resetAngularEvent=!1,isAdvancedPage=!1,isExternalSitesDialogBinded;serverApp.controller("PublishCtrl",["$scope","$http",function(n){n.selectedSites=[];n.activeSites=[];n.userLists=[];n.selectedDatasources=[];n.TargetSiteDetail=[];n.sampleDetail=[];n.activeMenu=[];n.PublishedItems=[];n.updateDatasources=[];n.updateUser=[];n.updateSites=[];n.publishType="Internal";isSelfHosted||(n.publishType="External");n.selectPublishType=function(t){n.publishType=t};n.setActive=function(t,i){n.activeMenu=t;$(".selected-sites li").removeClass("active");$(i.currentTarget).addClass("active");setTimeout(function(){pushDatasources();pushUserList();$("#user-selected").addClass("selectpicker");$("#user-selected").selectpicker("refresh")},100)}}]);$(document).on("click","#active-sites-dropdown .bootstrap-select .dropdown-menu .selectpicker li a",function(n){n.stopPropagation();var t=angular.element("[ng-controller=PublishCtrl]").scope();t.selectedSites=[];$.each($("#active-sites-dropdown option:selected"),function(n,i){var r=t.activeSites.find(n=>n.TenantId==i.attributes.id.value);t.selectedSites.push({SiteIdentifier:r.SiteIdentifier,TenantId:r.TenantId,TenantName:r.TenantName})});activateSubmit();resetAngularEvent=!0;t.$apply()});$(document).on("click","#selected-datasources .bootstrap-select .dropdown-menu .selectpicker li a",function(n){n.stopPropagation();var t=angular.element("[ng-controller=PublishCtrl]").scope(),i=t.TargetSiteDetail.find(n=>n.TenantId==t.activeMenu.TenantId),r=i.Datasources.find(t=>t.Id==$("#selected-datasources option")[$(n.target.parentElement).index()].value);r.IsLocked=$(n.target.parentElement).hasClass("selected")?!0:!1});$(document).on("click",".users-list .bootstrap-select .dropdown-menu .selectpicker li a",function(n){var t=angular.element("[ng-controller=PublishCtrl]").scope(),i=[],r,u;i=t.publishType==="Internal"?t.userLists.find(n=>n.SiteIdentifier==t.activeMenu.SiteIdentifier):t.userLists.find(n=>n.SiteIdentifier==t.activeMenu.TenantId);r=i.UserList.find(n=>n.IsSelected==!0);typeof r!="undefined"&&(r.IsSelected=!1);u=i.UserList.find(t=>t.UserId==$(".users-list option")[$(n.target.parentElement).index()].value);u.IsSelected=!0});$(document).on("change","input","textarea",function(){resetAngularEvent=!0});$(document).on("keyup focusout","#active-sites-dropdown",function(){$("#active-sites-dropdown li.selected").length>0?($("#active-sites-dropdown .bootstrap-select .selectpicker").removeClass("has-error"),$("#add-external-sites .btn.btn-default").removeClass("has-error"),$("#active-sites-validation").html("")):($("#active-sites-validation").html(window.Server.App.LocalizationContent.SelectSites),$("#active-sites-dropdown .bootstrap-select .selectpicker").addClass("has-error"),$("#add-external-sites .btn.btn-default").addClass("has-error"));activateSubmit()});$(document).on("keyup focusout","#publish-category-name",function(){var n=$("#publish-category-name").val().trim();parent.isEmptyOrWhitespace(n)?($("#publish-category-validation").html(""),$("#publish-plugin-validation").html(window.Server.App.LocalizationContent.Categoryvalidator),$("#publish-category-name").addClass("has-error")):parent.IsValidName("name",n)?($("#publish-category-name").removeClass("has-error"),$("#publish-category-validation").html(""),$("#publish-plugin-validation").html("")):($("#publish-plugin-validation").html(""),$("#publish-category-validation").html(window.Server.App.LocalizationContent.AvoidSpecialCharactors),$("#publish-category-name").addClass("has-error"));activateSubmit()});$(document).on("keyup focusout","#advanced-category-name",function(){var n=$("#advanced-category-name").val().trim();parent.isEmptyOrWhitespace(n)?($("#advanced-category-validation").html(""),$("#advanced-plugin-validation").html(window.Server.App.LocalizationContent.ItemNameValidator),$("#advanced-category-name").addClass("has-error")):parent.IsValidName("name",n)?($("#advanced-category-name").removeClass("has-error"),$("#advanced-category-validation").html(""),$("#advanced-plugin-validation").html("")):($("#advanced-plugin-validation").html(""),$("#advanced-category-validation").html(window.Server.App.LocalizationContent.AvoidSpecialCharactors),$("#advanced-category-name").addClass("has-error"));activateSubmit()});isExternalSitesDialogBinded=!1;$(document).ready(function(){$.validator.addMethod("isRequired",function(n){return!isEmptyOrWhitespace(n)},window.Server.App.LocalizationContent.ItemNameValidator);$.validator.addMethod("isValidName",function(n){return IsValidName("name",n)},window.Server.App.LocalizationContent.AvoidSpecialCharactors);$.validator.addMethod("additionalSpecialCharValidation",function(n){if(/^[a-zA-Z_0-9`~!\$\^()=\-\.\{\} ]+$/.test(n)||n==="")return!0},window.Server.App.LocalizationContent.AvoidSpecialCharactors);$.validator.addMethod("isSiteNameValid",function(n){return isSiteNameExist(n)},window.Server.App.LocalizationContent.SiteNameExist);$.validator.addMethod("isValidUrl",function(n){return!isValidUrl(n)},window.Server.App.LocalizationContent.IsValidUrl);$("#dialog-container").validate({errorElement:"span",onkeyup:function(n,t){t.keyCode!=9?(isKeyUp=!0,$(n).valid(),isKeyUp=!1):!0},onfocusout:function(n){$(n).valid()},rules:{"external-site-name-input":{isRequired:!0,isValidName:!0,isSiteNameValid:!0,additionalSpecialCharValidation:!0},"external-client-id-input":{isRequired:!0},"external-client-secret-input":{isRequired:!0},"external-site-url-input":{isRequired:!0,isValidUrl:!0}},highlight:function(n){$(n).closest("div").addClass("has-error")},unhighlight:function(n){$(n).closest("div").removeClass("has-error");$(n).closest("div").find("span").html("")},errorPlacement:function(n,t){$(t).closest("div").find("span").html(n.html()).show()},messages:{"external-site-name-input":{isRequired:window.Server.App.LocalizationContent.ItemNameValidator},"external-client-id-input":{isRequired:window.Server.App.LocalizationContent.ClientId},"external-client-secret-input":{isRequired:window.Server.App.LocalizationContent.ClientSecret},"external-site-url-input":{isRequired:window.Server.App.LocalizationContent.SiteURL}}})});$(document).on("keyup focusout","#external-site-name",function(n){var t=$("#external-site-name").val().toLowerCase().trim();n.type==="focusout"?isNullOrWhitespace(t)||siteNameCheck(t):(isNullOrWhitespace(t)||($(".name-validation-message").html(""),parent.$("#external-site-name").removeClass("has-error")),$("[name='external-site-name-input']").valid())});$(document).on("focusout","#external-site-url",function(){var n=$("#external-site-url").val().toLowerCase().trim();isNullOrWhitespace(n)||isValidUrl(n)||parent.$("#external-site-url").removeClass("has-error")});$(document).on("ready",function(){$(".show-hide-password").on("mousedown",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(".show-hide-password").on("mouseup",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(".show-hide-password").bind("touchstart",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});$(".show-hide-password").on("touchend",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")});if($(".show-hide-password").mouseleave(function(){$(this).siblings("input").attr("type","password")}),window.innerWidth<1041)$(".show-hide-password").on("click",function(){$(this).siblings("input").is(":password")?$(this).siblings("input").attr("type","text"):$(this).siblings("input").attr("type","password")})})