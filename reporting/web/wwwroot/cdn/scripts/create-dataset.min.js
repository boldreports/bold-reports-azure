/*!
*  filename: create-dataset.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function initializeToastControl(){toastInstance=new ejs.notifications.Toast({title:"Success!",content:"Data Source has been created successfully",target:document.body,cssClass:"e-toast-success",timeOut:1e3,close:function(){toastInstance.toastCloseCb()},position:{X:"Right",Y:"Top"},showCloseButton:!0,newestOnTop:!0,animation:{hide:{effect:"SlideRightOut"},show:{effect:"SlideRightIn"}}});toastInstance.appendTo(".ds-toast")}function showToast(n){toastInstance.show();toastInstance.toastCloseCb=n}function closePopup(){parent.$(".cds-iframe").attr("src","");parent.$(".cds-popup").ejDialog("close")}function initializeDataSetFormTooltip(){$(".dataset-form-container").ejTooltip({content:"description",target:".e-rptdesigner-error-icon",position:{target:{horizontal:"bottom",vertical:"bottom"},stem:{horizontal:"right",vertical:"top"}},tip:{adjust:{xValue:10,yValue:100}},animation:{effect:"Fade",speed:500},isBalloon:!1,showShadow:!0,showRoundedCorner:!0,beforeOpen:function(n){this.setModel({content:$(n.event.target).attr("data-title")})}})}function isSpecialCharacter(n){let t=new RegExp(/[!"#$%&'()*+,\s./:;<=>?@[\\\]^`{|}~-]/g);return t.test(n)}let createDataSetApp=angular.module("createDataSetApp",[]);createDataSetApp.config(["$httpProvider",function(n){n.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";n.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded"}]);createDataSetApp.service("ajaxService",["$http","$q",function(n,t){function u(n){return!angular.isObject(n.data)||!n.data.message?t.reject(window.Server.App.LocalizationContent.UnknownError):t.reject(n.data.message)}function f(n){return n.data}let i,r=!1;return{get:function(e){r&&i.resolve();r=!0;i=t.defer();let o=n({method:"get",url:e,timeout:i.promise});return o.then(f,u)},postQueryData:function(t,i){let r=n({method:"post",url:t,data:JSON.stringify(i),headers:{"Content-Type":"application/json"}});return r.then(f,u)},cancelRequest:function(){r&&i.resolve()}}}]);let toastInstance;$(document).ready(function(){initializeToastControl();window.parent.$("#create-dataset-popup_wrapper").ejWaitingPopup("hide")});createDataSetApp.controller("createDataSetCtrl",["$scope",function(n){n.useExistingDataSource=!1;n.isDataSourceList=!1;n.changeExistingDataSource=function(t){n.useExistingDataSource=t};n.updateIsDataSourceList=function(t){n.isDataSourceList=t}}]);createDataSetApp.controller("connectDataSetHeaderCtrl",["$scope",function(n){n.onCloseBtnClick=function(){parent.window.location.href=dataset}}]);createDataSetApp.controller("dataSetContainerCtrl",["$scope",function(n){n.dataSourceName=undefined;n.filterTimeout=undefined;n.updateDataSourceName=function(t){n.dataSourceName=t};n.$parent.updateIsDataSourceList(!0)}]);let dataSetScope;createDataSetApp.controller("dataSetCtrl",["$scope","$timeout","ajaxService",function(n,t,i){dataSetScope=n;n.dataSourceList=[];n.dataList=[];(getDataSetList=function(){showWaitingPopup(".ds-container");angular.element(".e-waitpopup-pane ").css("background-color","transparent");i.postQueryData(getDataSources,{}).then(function(t){n.dataList=t.result;n.dataSourceList=n.dataList.slice();hideWaitingPopup(".ds-container");angular.element(".e-waitpopup-pane ").css("background-color","#383838")})})();initializeDataSetFormTooltip();n.updateDataSetContainerHeight=function(){angular.element(".ds-dataset").css("height",window.innerHeight-angular.element(".cds-header-container").height()-angular.element(".cds-footer-container").height())};n.updateScrollBar=function(){n.$parent.isDataSourceList?angular.element(".ds-datasource-lists").css("height",window.innerHeight-(angular.element(".ds-datasource-lists")[0].getBoundingClientRect().top-angular.element(".cds-header-container")[0].getBoundingClientRect().top)-angular.element(".cds-footer-container").height()-23):angular.element(".ds-container").css("height",window.innerHeight-(angular.element(".ds-dataset")[0].getBoundingClientRect().top-angular.element(".cds-header-container")[0].getBoundingClientRect().top)-angular.element(".cds-footer-container").height()-66)};n.updateScrollBar();window.addEventListener("resize",n.updateDataSetContainerHeight);n.onDataSourceClick=function(t,i){let r=document.querySelector(".ds-datasource-list.ds-selected");r&&r.classList.remove("ds-selected");t.currentTarget.classList.add("ds-selected");n.$parent.updateDataSourceName(i)};n.onAutocompleteTailClick=function(t){t.currentTarget.classList.contains("ds-delete")&&(n.searchText="")};n.$watch("searchText",function(i){n.filterTimeout&&t.cancel(n.filterTimeout);n.filterTimeout=t(function(){n.dataSourceList=n.filterConnectorList(i);n.dataSourceName&&n.dataSourceName.toLowerCase().indexOf(i)===-1&&n.$parent.updateDataSourceName(undefined)},200)});n.filterConnectorList=function(t){return n.dataList&&n.dataList.length?n.dataList.filter(function(n){return t?n.Name.toLowerCase().indexOf(t)!==-1:!0}):[]};n.$on("$destroy",function(){window.removeEventListener("resize",n.updateDataContainerHeight)})}]);createDataSetApp.controller("DataSetCardCtrl",["$scope","$window",function(n,t){(n.onDataSetCardResize=function(){angular.element(".cds-card-container").css("height",window.innerHeight-angular.element(".cds-header-container").height())})();n.onCreateDataSourceClick=function(){parent.window.location.href=createDatasource};n.onExistingDataSourceClick=function(){n.$parent.changeExistingDataSource(!0)};angular.element(t).on("resize",function(){n.onDataSetCardResize()});n.$on("$destroy",function(){window.angular.element(t).off("resize")})}]);let validateDataSetForm=function(n,t){hideDataSetFormValidation();let r=$(".dataset-form-name").val(),i=!0;r.length?isSpecialCharacter(r)&&(i=!1,toggleDataSetFormValidationMsg($(".dataset-form-name").closest("table"),!0,"Name should not contain spaces and special characters")):(i=!1,toggleDataSetFormValidationMsg($(".dataset-form-name").closest("table"),!0,"Specify the DataSet name"));i?n.postQueryData(isDataSetExistUrl,{dataSetName:r}).then(function(n){n.Data&&toggleDataSetFormValidationMsg($(".dataset-form-name").closest("table"),!0,"DataSet name already exists");t(!n.Data)}):t(i)},hideDataSetFormValidation=function(){toggleDataSetFormValidationMsg($(".dataset-form-name").closest("table"))},toggleDataSetFormValidationMsg=function(n,t,i){t=t===undefined?!1:t;n.find(".e-rptdesigner-error-icon").css("display",t?"block":"none");n.find(".e-designer-content-label")[t?"addClass":"removeClass"]("e-rptdesigner-error");i&&n.find(".e-rptdesigner-error-icon").attr("data-title",i)};createDataSetApp.controller("dataSetFooterCtrl",["$scope","ajaxService",function(n,t){n.onBackBtnClick=function(){n.$parent.changeExistingDataSource(!1)};n.onConnectBtnClick=function(){n.$parent.updateIsDataSourceList(!1);dataSetScope.updateScrollBar()};n.onDataSetFormBackBtnClick=function(){n.$parent.updateIsDataSourceList(!0)};n.onProceedBtnClick=function(){showWaitingPopup(".cds-container");validateDataSetForm(t,function(n){n&&($(".dataset-form").submit(),parent.window.location.href=dataset);hideWaitingPopup(".cds-container")})}}])